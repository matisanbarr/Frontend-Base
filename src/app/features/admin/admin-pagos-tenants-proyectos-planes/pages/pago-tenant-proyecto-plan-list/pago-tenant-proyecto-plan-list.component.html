<!-- Lista paginada de asignaciones Tenant-Proyecto-Plan -->
<div *ngIf="loading">Cargando...</div>
<table *ngIf="!loading && asignaciones.length > 0" class="table table-striped">
  <thead>
    <tr>
      <th>Empresa</th>
      <th>Proyecto</th>
      <th>Plan</th>
      <th>Fecha Inicio</th>
      <th>Fecha Vencimiento</th>
      <th>R. Automática</th>
      <th>Activo</th>
      <th style="width: 120px">Acciones</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let a of asignaciones">
      <td>{{ a.tenant?.nombre || a.tenantId }}</td>
      <td>{{ a.proyecto?.nombre || a.proyectoId }}</td>
      <td>{{ a.plan?.nombre || a.planId }}</td>
      <td>{{ a.fechaInicio | date: 'longDate' : '' : 'es-CL' }}</td>
      <td>{{ a.fechaVencimiento | date: 'longDate' : '' : 'es-CL' }}</td>
      <td>{{ a.renovacionAutomatica ? 'Sí' : 'No' }}</td>
      <td>{{ a.estadoActivo ? 'Sí' : 'No' }}</td>
      <td>
        <button
          class="btn btn-sm btn-warning me-1"
          title="Editar"
          (click)="$event.stopPropagation(); onEdit(a)"
        >
          <i class="bi bi-pencil"></i>
        </button>
        <button class="btn btn-sm btn-danger" title="Eliminar" (click)="onConfirmDelete(a)">
          <i class="bi bi-trash"></i>
        </button>
      </td>
    </tr>
  </tbody>
</table>
<div *ngIf="!loading && asignaciones.length === 0">No hay asignaciones.</div>

<!-- Paginador similar a admin-users -->
<div *ngIf="totalPaginas > 1" class="d-flex align-items-center p-2">
  <button
    *ngIf="pagina > 1"
    class="btn btn-outline-info btn-sm rounded-pill me-2 px-3"
    (click)="cambiarPagina(pagina - 1)"
  >
    Anterior
  </button>
  <span class="flex-grow-1 text-center">Página {{ pagina }} de {{ totalPaginas }}</span>
  <button
    *ngIf="pagina < totalPaginas"
    class="btn btn-outline-info btn-sm rounded-pill ms-2 px-3"
    (click)="cambiarPagina(pagina + 1)"
  >
    Siguiente
  </button>
</div>

<!-- Modal de confirmación de eliminación -->
<app-confirm-modal
  *ngIf="showDeleteModal"
  [message]="'¿Estás seguro que deseas eliminar esta asignación?'"
  confirmText="Eliminar"
  cancelText="Cancelar"
  (confirm)="onDelete()"
  (cancel)="showDeleteModal = false"
></app-confirm-modal>
